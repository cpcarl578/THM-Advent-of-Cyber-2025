# Advent of Cyber Day 15-Web Attack Forensics-Drone alone

![Static Badge](https://img.shields.io/badge/Splunk-Basics?logo=splunk&logoColor=white&labelColor=gray&color=red)

## Objectives

* Detect and analyze malicious web activity through Apache access and error logs
* Investigate OS-level attacker actions using Sysmon data
* Identify and decode suspicious or obfuscated attacker payloads
* Reconstruct the full attack chain using Splunk for Blue Team investigation

### Skills Learned/Lessons learned

* More familiarization with Splunk
* Investigation of commands run on the command line
* Splunk is a powerful tool to see a wide range of data from various sources

### Tools used

* TryHackMe
* Splunk
* Base64decode

## Flags

* No flags today

### Practical portion

1. Start the attacker machine
2. Start the target machine
3. Access the Splunk dashboard
4. Login to Splunk Enterprise
5. Adjust search history to the last 7 days
6. Run a query for command injection attacks
7. Look at the different events displayed
8. Click on one and copy the base64encoding
9. Go to base64decode.org
10. Paste the encoding and decode
11. Start inspecting server side errors or command execution in apache error logs by running a query in splunk
12. Find three events and they all attempted to run the same commands
13. Investigate suspicious process creation
14. Find some interesting details about the processes
15. Look at attacker enumeration
16. Attacker ran whoami.exe after code was executed to determine user account status
17. Run a query to see if there were any encoded commands that were successful
18. Search returns none confirming that our system was setup properly

## Takeaways from todays room

Using splunk seemed very overwhelming at first given the shear amount of data presented. This is the second time I have used it and am slowly understanding some of the many features that can be used to investigate. This is a very powerful tool to conduct investigations as It shows the exact Commands run and the output of the CLI and can give descriptors to help you understand things a little easier. The descriptors that Splunk shows can be especially helpful to someone like myself who is still very new to this.
